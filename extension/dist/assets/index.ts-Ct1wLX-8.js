(function(){function s(){const t=document.querySelectorAll("img");let n=!1;return t.forEach(e=>{const o=(e.alt+e.src).toLowerCase();(o.includes("verified")||o.includes("secure"))&&(n=!0)}),{hasFakeBadge:n}}function i(){const t=document.body.innerText.toLowerCase(),n=["immediately","expires in","unauthorized access","account limited"];let e=0;return n.forEach(o=>{t.includes(o)&&e++}),{hasUrgencyText:e>=2}}function c(){const t=/card|cc_|cvv|pass|ssn|identity|bank/i;document.addEventListener("focusin",n=>{const e=n.target;if(e.tagName!=="INPUT")return;const o=[e.name,e.id,e.placeholder].join(" ");t.test(o)&&(console.log("[SentinelTK] Sensitive input focused"),chrome.runtime.sendMessage({type:"PAGE_SIGNALS",data:{hasSensitiveInput:!0}}))}),document.addEventListener("paste",n=>{const e=n.target,o=[e.name,e.id].join(" ");t.test(o)&&console.log("[SentinelTK] Paste detected in sensitive field")})}console.log("[SentinelTK] Content Script Loaded");setTimeout(()=>{r()},500);c();function r(){const t={...s(),...i()};chrome.runtime.sendMessage({type:"PAGE_SIGNALS",data:t})}chrome.runtime.onMessage.addListener(t=>{t.type==="RISK_ACTION"&&t.action==="BLOCK_FORM"&&a()});function a(){document.querySelectorAll("form").forEach(n=>{n.style.opacity="0.5",n.style.pointerEvents="none";const e=document.createElement("div");e.innerText="SentinelTK: Suspicious form detected. Input locked.",e.style.cssText="background:red; color:white; padding:10px; font-weight:bold;",n.prepend(e)})}
})()
